<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - BHRC</title>
    <meta name="description" content="BHRC Admin Dashboard - Manage complaints, events, members, donations and more">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../assets/images/favicon.ico">
    
    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/common.css">
    <link rel="stylesheet" href="../assets/admin.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="admin-body">
    <!-- Admin Header -->
    <header class="admin-header">
        <div class="admin-header-content">
            <div class="admin-logo">
                <img src="../assets/images/logo.png" alt="BHRC Logo">
                <span>BHRC Admin</span>
            </div>
            
            <div class="admin-header-actions">
                <div class="admin-notifications">
                    <button class="notification-btn" id="notificationBtn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-count" id="notificationCount">0</span>
                    </button>
                    <div class="notification-dropdown" id="notificationDropdown">
                        <div class="notification-header">
                            <h4>Notifications</h4>
                            <button class="mark-all-read" id="markAllRead">Mark all as read</button>
                        </div>
                        <div class="notification-list" id="notificationList">
                            <!-- Notifications will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <div class="admin-user">
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-info">
                        <span class="user-name" id="adminName">Admin</span>
                        <span class="user-role" id="adminRole">Administrator</span>
                    </div>
                    <div class="user-dropdown">
                        <button class="dropdown-btn" id="userDropdownBtn">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="dropdown-menu" id="userDropdownMenu">
                            <a href="#" id="profileLink"><i class="fas fa-user"></i> Profile</a>
                            <a href="#" id="settingsLink"><i class="fas fa-cog"></i> Settings</a>
                            <a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Admin Sidebar -->
    <aside class="admin-sidebar" id="adminSidebar">
        <nav class="sidebar-nav">
            <ul class="nav-menu">
                <li class="nav-item active">
                    <a href="#dashboard" class="nav-link" data-section="dashboard">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#complaints" class="nav-link" data-section="complaints">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Complaints</span>
                        <span class="nav-badge" id="complaintsBadge">0</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#events" class="nav-link" data-section="events">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Events</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#activities" class="nav-link" data-section="activities">
                        <i class="fas fa-tasks"></i>
                        <span>Activities</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#members" class="nav-link" data-section="members">
                        <i class="fas fa-users"></i>
                        <span>Members</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#donations" class="nav-link" data-section="donations">
                        <i class="fas fa-heart"></i>
                        <span>Donations</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#gallery" class="nav-link" data-section="gallery">
                        <i class="fas fa-images"></i>
                        <span>Gallery</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#users" class="nav-link" data-section="users">
                        <i class="fas fa-user-cog"></i>
                        <span>Users</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#reports" class="nav-link" data-section="reports">
                        <i class="fas fa-chart-bar"></i>
                        <span>Reports</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#settings" class="nav-link" data-section="settings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </li>
            </ul>
        </nav>
        
        <div class="sidebar-footer">
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="admin-main">
        <!-- Dashboard Section -->
        <section class="admin-section active" id="dashboardSection">
            <div class="section-header">
                <h1>Dashboard</h1>
                <div class="section-actions">
                    <button class="btn btn-primary" id="refreshDashboard">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon complaints">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalComplaints">247</h3>
                        <p>Total Complaints</p>
                        <span class="stat-change positive" id="complaintsChange">+12%</span>
                    </div>
                    <div class="stat-details">
                        <div class="stat-detail">
                            <span class="detail-label">Pending:</span>
                            <span class="detail-value" id="pendingComplaints">45</span>
                        </div>
                        <div class="stat-detail">
                            <span class="detail-label">Resolved:</span>
                            <span class="detail-value" id="resolvedComplaints">202</span>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon events">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalEvents">34</h3>
                        <p>Total Events</p>
                        <span class="stat-change positive" id="eventsChange">+8%</span>
                    </div>
                    <div class="stat-details">
                        <div class="stat-detail">
                            <span class="detail-label">Upcoming:</span>
                            <span class="detail-value" id="upcomingEvents">12</span>
                        </div>
                        <div class="stat-detail">
                            <span class="detail-label">Completed:</span>
                            <span class="detail-value" id="completedEvents">22</span>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon members">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalMembers">1,247</h3>
                        <p>Total Members</p>
                        <span class="stat-change positive" id="membersChange">+15%</span>
                    </div>
                    <div class="stat-details">
                        <div class="stat-detail">
                            <span class="detail-label">Active:</span>
                            <span class="detail-value" id="activeMembers">1,189</span>
                        </div>
                        <div class="stat-detail">
                            <span class="detail-label">New:</span>
                            <span class="detail-value" id="newMembers">58</span>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon donations">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalDonations">â‚¹2,45,670</h3>
                        <p>Total Donations</p>
                        <span class="stat-change positive" id="donationsChange">+23%</span>
                    </div>
                    <div class="stat-details">
                        <div class="stat-detail">
                            <span class="detail-label">This Month:</span>
                            <span class="detail-value" id="monthlyDonations">â‚¹45,230</span>
                        </div>
                        <div class="stat-detail">
                            <span class="detail-label">Donors:</span>
                            <span class="detail-value" id="totalDonors">189</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon activities">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalActivities">156</h3>
                        <p>Activities</p>
                        <span class="stat-change positive" id="activitiesChange">+18%</span>
                    </div>
                    <div class="stat-details">
                        <div class="stat-detail">
                            <span class="detail-label">Ongoing:</span>
                            <span class="detail-value" id="ongoingActivities">23</span>
                        </div>
                        <div class="stat-detail">
                            <span class="detail-label">Completed:</span>
                            <span class="detail-value" id="completedActivities">133</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon gallery">
                        <i class="fas fa-images"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalGalleryItems">892</h3>
                        <p>Gallery Items</p>
                        <span class="stat-change positive" id="galleryChange">+7%</span>
                    </div>
                    <div class="stat-details">
                        <div class="stat-detail">
                            <span class="detail-label">Photos:</span>
                            <span class="detail-value" id="totalPhotos">734</span>
                        </div>
                        <div class="stat-detail">
                            <span class="detail-label">Videos:</span>
                            <span class="detail-value" id="totalVideos">158</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon newsletter">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="newsletterSubscribers">2,134</h3>
                        <p>Newsletter Subscribers</p>
                        <span class="stat-change positive" id="newsletterChange">+9%</span>
                    </div>
                    <div class="stat-details">
                        <div class="stat-detail">
                            <span class="detail-label">Open Rate:</span>
                            <span class="detail-value" id="openRate">68%</span>
                        </div>
                        <div class="stat-detail">
                            <span class="detail-label">Campaigns:</span>
                            <span class="detail-value" id="totalCampaigns">24</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon system">
                        <i class="fas fa-server"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="systemHealth">98.5%</h3>
                        <p>System Health</p>
                        <span class="stat-change positive" id="systemChange">+0.2%</span>
                    </div>
                    <div class="stat-details">
                        <div class="stat-detail">
                            <span class="detail-label">Uptime:</span>
                            <span class="detail-value" id="systemUptime">99.9%</span>
                        </div>
                        <div class="stat-detail">
                            <span class="detail-label">Load:</span>
                            <span class="detail-value" id="systemLoad">Low</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="charts-row">
                <div class="chart-container">
                    <div class="chart-header">
                        <h3>Complaints Overview</h3>
                        <select id="complaintsChartPeriod">
                            <option value="7">Last 7 days</option>
                            <option value="30" selected>Last 30 days</option>
                            <option value="90">Last 3 months</option>
                        </select>
                    </div>
                    <canvas id="complaintsChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <h3>Donation Trends</h3>
                        <select id="donationsChartPeriod">
                            <option value="7">Last 7 days</option>
                            <option value="30" selected>Last 30 days</option>
                            <option value="90">Last 3 months</option>
                        </select>
                    </div>
                    <canvas id="donationsChart"></canvas>
                </div>
            </div>

            <!-- Recent Activities -->
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Recent Complaints</h3>
                        <a href="#complaints" class="view-all">View All</a>
                    </div>
                    <div class="card-content">
                        <div class="recent-list" id="recentComplaints">
                            <!-- Recent complaints will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Upcoming Events</h3>
                        <a href="#events" class="view-all">View All</a>
                    </div>
                    <div class="card-content">
                        <div class="recent-list" id="upcomingEvents">
                            <!-- Upcoming events will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Recent Donations</h3>
                        <a href="#donations" class="view-all">View All</a>
                    </div>
                    <div class="card-content">
                        <div class="recent-list" id="recentDonations">
                            <!-- Recent donations will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>System Status</h3>
                    </div>
                    <div class="card-content">
                        <div class="system-status">
                            <div class="status-item">
                                <span class="status-label">Database</span>
                                <span class="status-indicator online" id="dbStatus">Online</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Email Service</span>
                                <span class="status-indicator online" id="emailStatus">Online</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Payment Gateway</span>
                                <span class="status-indicator online" id="paymentStatus">Online</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Storage</span>
                                <span class="status-indicator online" id="storageStatus">Online</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Other sections will be loaded dynamically -->
        <section class="admin-section" id="complaintsSection">
            <div class="section-header">
                <h1>Complaints Management</h1>
                <div class="section-actions">
                    <button class="btn btn-secondary" id="exportComplaints">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn btn-primary" id="addComplaint">
                        <i class="fas fa-plus"></i> Add Complaint
                    </button>
                </div>
            </div>
            <div class="section-content" id="complaintsContent">
                <!-- Complaints content will be loaded here -->
            </div>
        </section>

        <section class="admin-section" id="eventsSection">
            <div class="section-header">
                <h1>Events Management</h1>
                <div class="section-actions">
                    <button class="btn btn-secondary" id="exportEvents">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn btn-primary" id="addEvent">
                        <i class="fas fa-plus"></i> Add Event
                    </button>
                </div>
            </div>
            <div class="section-content" id="eventsContent">
                <!-- Events content will be loaded here -->
            </div>
        </section>

        <section class="admin-section" id="activitiesSection">
            <div class="section-header">
                <h1>Activities Management</h1>
                <div class="section-actions">
                    <button class="btn btn-secondary" id="exportActivities">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn btn-primary" id="addActivity">
                        <i class="fas fa-plus"></i> Add Activity
                    </button>
                </div>
            </div>
            <div class="section-content" id="activitiesContent">
                <!-- Activities content will be loaded here -->
            </div>
        </section>

        <section class="admin-section" id="membersSection">
            <div class="section-header">
                <h1>Members Management</h1>
                <div class="section-actions">
                    <button class="btn btn-secondary" id="exportMembers">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn btn-primary" id="addMember">
                        <i class="fas fa-plus"></i> Add Member
                    </button>
                </div>
            </div>
            <div class="section-content" id="membersContent">
                <!-- Members content will be loaded here -->
            </div>
        </section>

        <section class="admin-section" id="donationsSection">
            <div class="section-header">
                <h1>Donations Management</h1>
                <div class="section-actions">
                    <button class="btn btn-secondary" id="exportDonations">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>
            <div class="section-content" id="donationsContent">
                <!-- Donations content will be loaded here -->
            </div>
        </section>

        <section class="admin-section" id="gallerySection">
            <div class="section-header">
                <h1>Gallery Management</h1>
                <div class="section-actions">
                    <button class="btn btn-primary" id="uploadImages">
                        <i class="fas fa-upload"></i> Upload Images
                    </button>
                </div>
            </div>
            <div class="section-content" id="galleryContent">
                <!-- Gallery content will be loaded here -->
            </div>
        </section>

        <section class="admin-section" id="usersSection">
            <div class="section-header">
                <h1>Users Management</h1>
                <div class="section-actions">
                    <button class="btn btn-secondary" id="exportUsers">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn btn-primary" id="addUser">
                        <i class="fas fa-plus"></i> Add User
                    </button>
                </div>
            </div>
            <div class="section-content" id="usersContent">
                <!-- Users content will be loaded here -->
            </div>
        </section>

        <section class="admin-section" id="reportsSection">
            <div class="section-header">
                <h1>Reports & Analytics</h1>
                <div class="section-actions">
                    <button class="btn btn-secondary" id="generateReport">
                        <i class="fas fa-file-pdf"></i> Generate Report
                    </button>
                </div>
            </div>
            <div class="section-content" id="reportsContent">
                <!-- Reports content will be loaded here -->
            </div>
        </section>

        <section class="admin-section" id="settingsSection">
            <div class="section-header">
                <h1>System Settings</h1>
                <div class="section-actions">
                    <button class="btn btn-primary" id="saveSettings">
                        <i class="fas fa-save"></i> Save Settings
                    </button>
                </div>
            </div>
            <div class="section-content" id="settingsContent">
                <!-- Settings content will be loaded here -->
            </div>
        </section>
    </main>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Loading...</p>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Modal Container -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-container" id="modalContainer">
            <!-- Modal content will be loaded here -->
        </div>
    </div>

    <!-- JavaScript -->
    <script src="assets/js/admin.js"></script>
    <script>
        // Load dashboard data
        async function loadDashboardData() {
            try {
                // Call the admin dashboard API
                const response = await fetch('/backend/api/admin-dashboard.php', {
                    headers: {
                        'Authorization': 'Bearer ' + localStorage.getItem('token'),
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    updateOverviewStats(data.overview_stats);
                    initializeCharts(data.chart_data);
                    loadRecentActivities(data.recent_activities);
                    updateSystemHealth(data.system_health);
                } else {
                    throw new Error('Failed to load dashboard data');
                }
            } catch (error) {
                console.error('Error loading dashboard:', error);
                showToast('Failed to load dashboard data', 'error');
                // Load mock data as fallback
                loadMockData();
            }
        }
    </script>
</body>
</html>


