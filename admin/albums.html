<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Albums - BHRC Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="../assets/css/common.css" rel="stylesheet">
    <link href="../assets/css/admin.css" rel="stylesheet">
    <style>
        .album-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            height: 100%;
        }
        .album-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .album-cover {
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }
        .album-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .album-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .album-card:hover .album-overlay {
            opacity: 1;
        }
        .album-stats {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
        }
        .album-actions {
            position: absolute;
            top: 10px;
            right: 10px;
        }
        .album-actions .btn {
            margin-left: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .album-card:hover .album-actions .btn {
            opacity: 1;
        }
        .create-album-card {
            border: 2px dashed #dee2e6;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 300px;
            transition: all 0.3s ease;
        }
        .create-album-card:hover {
            border-color: #007bff;
            background: #e3f2fd;
        }
        .album-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        .album-type-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h4><i class="fas fa-shield-alt"></i> BHRC Admin</h4>
        </div>
        <nav class="sidebar-nav">
            <a href="dashboard.html" class="nav-link">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </a>
            <a href="members.html" class="nav-link">
                <i class="fas fa-users"></i> Members
            </a>
            <a href="activities.html" class="nav-link">
                <i class="fas fa-calendar-alt"></i> Activities
            </a>
            <a href="events.html" class="nav-link">
                <i class="fas fa-calendar-check"></i> Events
            </a>
            <a href="gallery.html" class="nav-link">
                <i class="fas fa-images"></i> Gallery
            </a>
            <a href="albums.html" class="nav-link active">
                <i class="fas fa-folder"></i> Albums
            </a>
            <a href="photos.html" class="nav-link">
                <i class="fas fa-camera"></i> Photos
            </a>
            <a href="videos.html" class="nav-link">
                <i class="fas fa-video"></i> Videos
            </a>
            <a href="donations.html" class="nav-link">
                <i class="fas fa-heart"></i> Donations
            </a>
            <a href="complaints.html" class="nav-link">
                <i class="fas fa-exclamation-triangle"></i> Complaints
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <header class="main-header">
            <div class="header-left">
                <button class="btn btn-link sidebar-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1>Albums</h1>
            </div>
            <div class="header-right">
                <button class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#createAlbumModal">
                    <i class="fas fa-plus"></i> Create Album
                </button>
                <div class="dropdown">
                    <button class="btn btn-link dropdown-toggle" data-bs-toggle="dropdown">
                        <i class="fas fa-user-circle"></i> Admin
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#"><i class="fas fa-user"></i> Profile</a></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Settings</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                    </ul>
                </div>
            </div>
        </header>

        <!-- Content -->
        <div class="content-wrapper">
            <!-- Statistics Cards -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card bg-primary text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h6 class="card-title">Total Albums</h6>
                                    <h3 id="totalAlbums">0</h3>
                                </div>
                                <i class="fas fa-folder fa-2x opacity-75"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-success text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h6 class="card-title">Total Photos</h6>
                                    <h3 id="totalPhotos">0</h3>
                                </div>
                                <i class="fas fa-camera fa-2x opacity-75"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-info text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h6 class="card-title">Total Videos</h6>
                                    <h3 id="totalVideos">0</h3>
                                </div>
                                <i class="fas fa-video fa-2x opacity-75"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-warning text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h6 class="card-title">Storage Used</h6>
                                    <h3 id="storageUsed">0 GB</h3>
                                </div>
                                <i class="fas fa-hdd fa-2x opacity-75"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Filters and Search -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-search"></i></span>
                                <input type="text" class="form-control" id="searchInput" placeholder="Search albums...">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <select class="form-select" id="typeFilter">
                                <option value="">All Types</option>
                                <option value="photo">Photo Albums</option>
                                <option value="video">Video Albums</option>
                                <option value="mixed">Mixed Albums</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <select class="form-select" id="categoryFilter">
                                <option value="">All Categories</option>
                                <option value="events">Events</option>
                                <option value="activities">Activities</option>
                                <option value="achievements">Achievements</option>
                                <option value="members">Members</option>
                                <option value="gallery">Gallery</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <select class="form-select" id="sortBy">
                                <option value="created_desc">Newest First</option>
                                <option value="created_asc">Oldest First</option>
                                <option value="name_asc">Name A-Z</option>
                                <option value="name_desc">Name Z-A</option>
                                <option value="size_desc">Largest First</option>
                                <option value="size_asc">Smallest First</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <div class="btn-group w-100" role="group">
                                <input type="radio" class="btn-check" name="viewMode" id="gridView" value="grid" checked>
                                <label class="btn btn-outline-secondary" for="gridView">
                                    <i class="fas fa-th"></i>
                                </label>
                                <input type="radio" class="btn-check" name="viewMode" id="listView" value="list">
                                <label class="btn btn-outline-secondary" for="listView">
                                    <i class="fas fa-list"></i>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Albums Grid -->
            <div id="albumsContainer">
                <div class="album-grid" id="albumsGrid">
                    <!-- Albums will be loaded here -->
                </div>
            </div>

            <!-- Albums List View -->
            <div id="albumsList" style="display: none;">
                <div class="card">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>Album</th>
                                    <th>Type</th>
                                    <th>Category</th>
                                    <th>Items</th>
                                    <th>Size</th>
                                    <th>Created</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="albumsTableBody">
                                <!-- Albums will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Pagination -->
            <nav aria-label="Albums pagination" class="mt-4">
                <ul class="pagination justify-content-center" id="pagination">
                    <!-- Pagination will be generated here -->
                </ul>
            </nav>
        </div>
    </div>

    <!-- Create Album Modal -->
    <div class="modal fade" id="createAlbumModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Create New Album</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="createAlbumForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Album Name *</label>
                                    <input type="text" class="form-control" id="albumName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Album Type *</label>
                                    <select class="form-select" id="albumType" required>
                                        <option value="">Select Type</option>
                                        <option value="photo">Photo Album</option>
                                        <option value="video">Video Album</option>
                                        <option value="mixed">Mixed Album</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Category</label>
                                    <select class="form-select" id="albumCategory">
                                        <option value="">Select Category</option>
                                        <option value="events">Events</option>
                                        <option value="activities">Activities</option>
                                        <option value="achievements">Achievements</option>
                                        <option value="members">Members</option>
                                        <option value="gallery">Gallery</option>
                                        <option value="testimonials">Testimonials</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Privacy</label>
                                    <select class="form-select" id="albumPrivacy">
                                        <option value="public">Public</option>
                                        <option value="private">Private</option>
                                        <option value="members">Members Only</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" id="albumDescription" rows="3" placeholder="Enter album description"></textarea>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Cover Image</label>
                            <input type="file" class="form-control" id="albumCover" accept="image/*">
                            <small class="text-muted">Upload a cover image for the album (optional)</small>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Tags</label>
                            <input type="text" class="form-control" id="albumTags" placeholder="Enter tags separated by commas">
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="allowComments" checked>
                                    <label class="form-check-label" for="allowComments">
                                        Allow Comments
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="allowDownload">
                                    <label class="form-check-label" for="allowDownload">
                                        Allow Download
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="isFeatured">
                                    <label class="form-check-label" for="isFeatured">
                                        Featured Album
                                    </label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="createAlbum()">Create Album</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Album Modal -->
    <div class="modal fade" id="editAlbumModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Album</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editAlbumForm">
                        <input type="hidden" id="editAlbumId">
                        <!-- Same form fields as create album -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Album Name *</label>
                                    <input type="text" class="form-control" id="editAlbumName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Album Type *</label>
                                    <select class="form-select" id="editAlbumType" required>
                                        <option value="">Select Type</option>
                                        <option value="photo">Photo Album</option>
                                        <option value="video">Video Album</option>
                                        <option value="mixed">Mixed Album</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Category</label>
                                    <select class="form-select" id="editAlbumCategory">
                                        <option value="">Select Category</option>
                                        <option value="events">Events</option>
                                        <option value="activities">Activities</option>
                                        <option value="achievements">Achievements</option>
                                        <option value="members">Members</option>
                                        <option value="gallery">Gallery</option>
                                        <option value="testimonials">Testimonials</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Privacy</label>
                                    <select class="form-select" id="editAlbumPrivacy">
                                        <option value="public">Public</option>
                                        <option value="private">Private</option>
                                        <option value="members">Members Only</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" id="editAlbumDescription" rows="3"></textarea>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Cover Image</label>
                            <input type="file" class="form-control" id="editAlbumCover" accept="image/*">
                            <small class="text-muted">Upload a new cover image (optional)</small>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Tags</label>
                            <input type="text" class="form-control" id="editAlbumTags">
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="editAllowComments">
                                    <label class="form-check-label" for="editAllowComments">
                                        Allow Comments
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="editAllowDownload">
                                    <label class="form-check-label" for="editAllowDownload">
                                        Allow Download
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="editIsFeatured">
                                    <label class="form-check-label" for="editIsFeatured">
                                        Featured Album
                                    </label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="updateAlbum()">Update Album</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Album Details Modal -->
    <div class="modal fade" id="albumDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="albumDetailsTitle">Album Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="albumDetailsContent">
                        <!-- Album details will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3" id="toastContainer"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        class AlbumsManager {
            constructor() {
                this.albums = [];
                this.filteredAlbums = [];
                this.currentPage = 1;
                this.itemsPerPage = 12;
                this.currentView = 'grid';
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.loadAlbums();
                this.updateStats();
            }

            setupEventListeners() {
                // Search and filters
                document.getElementById('searchInput').addEventListener('input', () => this.filterAlbums());
                document.getElementById('typeFilter').addEventListener('change', () => this.filterAlbums());
                document.getElementById('categoryFilter').addEventListener('change', () => this.filterAlbums());
                document.getElementById('sortBy').addEventListener('change', () => this.filterAlbums());

                // View mode toggle
                document.querySelectorAll('input[name="viewMode"]').forEach(radio => {
                    radio.addEventListener('change', (e) => {
                        this.currentView = e.target.value;
                        this.toggleView();
                    });
                });
            }

            async loadAlbums() {
                try {
                    // Simulate API call
                    const response = await fetch(window.BHRC_CONFIG ? window.BHRC_CONFIG.API.BASE_URL + ''.replace('/api', '') : 'https://bhrcdata.online/backend/api'.replace('/api', '')));
                    // For demo, use mock data
                    this.albums = this.getMockAlbums();
                    this.filteredAlbums = [...this.albums];
                    this.renderAlbums();
                    this.updateStats();
                } catch (error) {
                    console.error('Error loading albums:', error);
                    // Use mock data for demo
                    this.albums = this.getMockAlbums();
                    this.filteredAlbums = [...this.albums];
                    this.renderAlbums();
                    this.updateStats();
                }
            }

            getMockAlbums() {
                return [
                    {
                        id: 1,
                        name: 'Annual Conference 2024',
                        type: 'mixed',
                        category: 'events',
                        description: 'Photos and videos from our annual conference',
                        cover: 'https://via.placeholder.com/300x200/007bff/ffffff?text=Conference+2024',
                        photoCount: 45,
                        videoCount: 8,
                        totalSize: '2.3 GB',
                        privacy: 'public',
                        created: '2024-01-15',
                        tags: ['conference', 'annual', '2024'],
                        isFeatured: true,
                        allowComments: true,
                        allowDownload: false
                    },
                    {
                        id: 2,
                        name: 'Community Workshop',
                        type: 'photo',
                        category: 'activities',
                        description: 'Workshop on community development',
                        cover: 'https://via.placeholder.com/300x200/28a745/ffffff?text=Workshop',
                        photoCount: 32,
                        videoCount: 0,
                        totalSize: '1.1 GB',
                        privacy: 'public',
                        created: '2024-01-10',
                        tags: ['workshop', 'community'],
                        isFeatured: false,
                        allowComments: true,
                        allowDownload: true
                    },
                    {
                        id: 3,
                        name: 'Achievement Awards',
                        type: 'video',
                        category: 'achievements',
                        description: 'Award ceremony highlights',
                        cover: 'https://via.placeholder.com/300x200/ffc107/000000?text=Awards',
                        photoCount: 0,
                        videoCount: 12,
                        totalSize: '3.8 GB',
                        privacy: 'members',
                        created: '2024-01-05',
                        tags: ['awards', 'achievements'],
                        isFeatured: true,
                        allowComments: true,
                        allowDownload: false
                    },
                    {
                        id: 4,
                        name: 'Member Profiles',
                        type: 'photo',
                        category: 'members',
                        description: 'Professional photos of our members',
                        cover: 'https://via.placeholder.com/300x200/17a2b8/ffffff?text=Members',
                        photoCount: 78,
                        videoCount: 0,
                        totalSize: '1.9 GB',
                        privacy: 'private',
                        created: '2024-01-01',
                        tags: ['members', 'profiles'],
                        isFeatured: false,
                        allowComments: false,
                        allowDownload: false
                    },
                    {
                        id: 5,
                        name: 'General Gallery',
                        type: 'mixed',
                        category: 'gallery',
                        description: 'Miscellaneous photos and videos',
                        cover: 'https://via.placeholder.com/300x200/6f42c1/ffffff?text=Gallery',
                        photoCount: 156,
                        videoCount: 23,
                        totalSize: '4.7 GB',
                        privacy: 'public',
                        created: '2023-12-20',
                        tags: ['gallery', 'misc'],
                        isFeatured: false,
                        allowComments: true,
                        allowDownload: true
                    }
                ];
            }

            filterAlbums() {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const typeFilter = document.getElementById('typeFilter').value;
                const categoryFilter = document.getElementById('categoryFilter').value;
                const sortBy = document.getElementById('sortBy').value;

                this.filteredAlbums = this.albums.filter(album => {
                    const matchesSearch = album.name.toLowerCase().includes(searchTerm) ||
                                        album.description.toLowerCase().includes(searchTerm) ||
                                        album.tags.some(tag => tag.toLowerCase().includes(searchTerm));
                    const matchesType = !typeFilter || album.type === typeFilter;
                    const matchesCategory = !categoryFilter || album.category === categoryFilter;

                    return matchesSearch && matchesType && matchesCategory;
                });

                // Sort albums
                this.filteredAlbums.sort((a, b) => {
                    switch (sortBy) {
                        case 'created_desc':
                            return new Date(b.created) - new Date(a.created);
                        case 'created_asc':
                            return new Date(a.created) - new Date(b.created);
                        case 'name_asc':
                            return a.name.localeCompare(b.name);
                        case 'name_desc':
                            return b.name.localeCompare(a.name);
                        case 'size_desc':
                            return parseFloat(b.totalSize) - parseFloat(a.totalSize);
                        case 'size_asc':
                            return parseFloat(a.totalSize) - parseFloat(b.totalSize);
                        default:
                            return 0;
                    }
                });

                this.currentPage = 1;
                this.renderAlbums();
            }

            renderAlbums() {
                if (this.currentView === 'grid') {
                    this.renderGridView();
                } else {
                    this.renderListView();
                }
                this.renderPagination();
            }

            renderGridView() {
                const container = document.getElementById('albumsGrid');
                const startIndex = (this.currentPage - 1) * this.itemsPerPage;
                const endIndex = startIndex + this.itemsPerPage;
                const albumsToShow = this.filteredAlbums.slice(startIndex, endIndex);

                let html = `
                    <div class="create-album-card" data-bs-toggle="modal" data-bs-target="#createAlbumModal">
                        <div class="text-center">
                            <i class="fas fa-plus fa-3x text-muted mb-3"></i>
                            <h5 class="text-muted">Create New Album</h5>
                        </div>
                    </div>
                `;

                albumsToShow.forEach(album => {
                    const totalItems = album.photoCount + album.videoCount;
                    const typeIcon = album.type === 'photo' ? 'camera' : 
                                   album.type === 'video' ? 'video' : 'images';
                    const privacyIcon = album.privacy === 'public' ? 'globe' : 
                                      album.privacy === 'members' ? 'users' : 'lock';

                    html += `
                        <div class="album-card card" onclick="viewAlbum(${album.id})">
                            <div class="album-cover">
                                <img src="${album.cover}" alt="${album.name}">
                                <div class="album-overlay">
                                    <button class="btn btn-light btn-sm" onclick="event.stopPropagation(); viewAlbum(${album.id})">
                                        <i class="fas fa-eye"></i> View
                                    </button>
                                </div>
                                <div class="album-stats">
                                    <i class="fas fa-${typeIcon}"></i> ${totalItems} items
                                </div>
                                <div class="album-actions">
                                    <button class="btn btn-sm btn-light" onclick="event.stopPropagation(); editAlbum(${album.id})" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger" onclick="event.stopPropagation(); deleteAlbum(${album.id})" title="Delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                <span class="badge bg-${album.type === 'photo' ? 'success' : album.type === 'video' ? 'info' : 'primary'} album-type-badge">
                                    ${album.type.charAt(0).toUpperCase() + album.type.slice(1)}
                                </span>
                            </div>
                            <div class="card-body">
                                <h6 class="card-title d-flex justify-content-between align-items-center">
                                    ${album.name}
                                    ${album.isFeatured ? '<i class="fas fa-star text-warning" title="Featured"></i>' : ''}
                                </h6>
                                <p class="card-text text-muted small">${album.description}</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <small class="text-muted">
                                        <i class="fas fa-${privacyIcon}"></i> ${album.privacy}
                                    </small>
                                    <small class="text-muted">${album.totalSize}</small>
                                </div>
                                <div class="mt-2">
                                    ${album.tags.map(tag => `<span class="badge bg-light text-dark me-1">${tag}</span>`).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            }

            renderListView() {
                const tbody = document.getElementById('albumsTableBody');
                const startIndex = (this.currentPage - 1) * this.itemsPerPage;
                const endIndex = startIndex + this.itemsPerPage;
                const albumsToShow = this.filteredAlbums.slice(startIndex, endIndex);

                const html = albumsToShow.map(album => {
                    const totalItems = album.photoCount + album.videoCount;
                    const typeIcon = album.type === 'photo' ? 'camera' : 
                                   album.type === 'video' ? 'video' : 'images';
                    const privacyIcon = album.privacy === 'public' ? 'globe' : 
                                      album.privacy === 'members' ? 'users' : 'lock';

                    return `
                        <tr onclick="viewAlbum(${album.id})" style="cursor: pointer;">
                            <td>
                                <div class="d-flex align-items-center">
                                    <img src="${album.cover}" alt="${album.name}" class="rounded me-3" style="width: 50px; height: 50px; object-fit: cover;">
                                    <div>
                                        <h6 class="mb-0">${album.name} ${album.isFeatured ? '<i class="fas fa-star text-warning ms-1"></i>' : ''}</h6>
                                        <small class="text-muted">${album.description}</small>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <span class="badge bg-${album.type === 'photo' ? 'success' : album.type === 'video' ? 'info' : 'primary'}">
                                    <i class="fas fa-${typeIcon}"></i> ${album.type}
                                </span>
                            </td>
                            <td>${album.category}</td>
                            <td>${totalItems} items</td>
                            <td>${album.totalSize}</td>
                            <td>${new Date(album.created).toLocaleDateString()}</td>
                            <td>
                                <div class="btn-group btn-group-sm">
                                    <button class="btn btn-outline-primary" onclick="event.stopPropagation(); viewAlbum(${album.id})" title="View">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-outline-secondary" onclick="event.stopPropagation(); editAlbum(${album.id})" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-outline-danger" onclick="event.stopPropagation(); deleteAlbum(${album.id})" title="Delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                }).join('');

                tbody.innerHTML = html;
            }

            toggleView() {
                const gridContainer = document.getElementById('albumsContainer');
                const listContainer = document.getElementById('albumsList');

                if (this.currentView === 'grid') {
                    gridContainer.style.display = 'block';
                    listContainer.style.display = 'none';
                } else {
                    gridContainer.style.display = 'none';
                    listContainer.style.display = 'block';
                }

                this.renderAlbums();
            }

            renderPagination() {
                const totalPages = Math.ceil(this.filteredAlbums.length / this.itemsPerPage);
                const pagination = document.getElementById('pagination');

                if (totalPages <= 1) {
                    pagination.innerHTML = '';
                    return;
                }

                let html = '';

                // Previous button
                html += `
                    <li class="page-item ${this.currentPage === 1 ? 'disabled' : ''}">
                        <a class="page-link" href="#" onclick="albumsManager.changePage(${this.currentPage - 1})">Previous</a>
                    </li>
                `;

                // Page numbers
                for (let i = 1; i <= totalPages; i++) {
                    if (i === 1 || i === totalPages || (i >= this.currentPage - 2 && i <= this.currentPage + 2)) {
                        html += `
                            <li class="page-item ${i === this.currentPage ? 'active' : ''}">
                                <a class="page-link" href="#" onclick="albumsManager.changePage(${i})">${i}</a>
                            </li>
                        `;
                    } else if (i === this.currentPage - 3 || i === this.currentPage + 3) {
                        html += '<li class="page-item disabled"><span class="page-link">...</span></li>';
                    }
                }

                // Next button
                html += `
                    <li class="page-item ${this.currentPage === totalPages ? 'disabled' : ''}">
                        <a class="page-link" href="#" onclick="albumsManager.changePage(${this.currentPage + 1})">Next</a>
                    </li>
                `;

                pagination.innerHTML = html;
            }

            changePage(page) {
                const totalPages = Math.ceil(this.filteredAlbums.length / this.itemsPerPage);
                if (page >= 1 && page <= totalPages) {
                    this.currentPage = page;
                    this.renderAlbums();
                }
            }

            updateStats() {
                const totalAlbums = this.albums.length;
                const totalPhotos = this.albums.reduce((sum, album) => sum + album.photoCount, 0);
                const totalVideos = this.albums.reduce((sum, album) => sum + album.videoCount, 0);
                const totalStorage = this.albums.reduce((sum, album) => sum + parseFloat(album.totalSize), 0);

                document.getElementById('totalAlbums').textContent = totalAlbums;
                document.getElementById('totalPhotos').textContent = totalPhotos;
                document.getElementById('totalVideos').textContent = totalVideos;
                document.getElementById('storageUsed').textContent = totalStorage.toFixed(1) + ' GB';
            }

            async createAlbum() {
                const form = document.getElementById('createAlbumForm');
                const formData = new FormData(form);

                const albumData = {
                    name: document.getElementById('albumName').value,
                    type: document.getElementById('albumType').value,
                    category: document.getElementById('albumCategory').value,
                    description: document.getElementById('albumDescription').value,
                    privacy: document.getElementById('albumPrivacy').value,
                    tags: document.getElementById('albumTags').value.split(',').map(tag => tag.trim()).filter(tag => tag),
                    allowComments: document.getElementById('allowComments').checked,
                    allowDownload: document.getElementById('allowDownload').checked,
                    isFeatured: document.getElementById('isFeatured').checked
                };

                try {
                    // Simulate API call
                    const response = await fetch(window.BHRC_CONFIG ? window.BHRC_CONFIG.API.BASE_URL + ''.replace('/api', '') : 'https://bhrcdata.online/backend/api'.replace('/api', '')), {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(albumData)
                    });

                    // For demo, simulate success
                    const newAlbum = {
                        id: Date.now(),
                        ...albumData,
                        cover: 'https://via.placeholder.com/300x200/6c757d/ffffff?text=' + encodeURIComponent(albumData.name),
                        photoCount: 0,
                        videoCount: 0,
                        totalSize: '0 MB',
                        created: new Date().toISOString().split('T')[0]
                    };

                    this.albums.unshift(newAlbum);
                    this.filterAlbums();
                    this.updateStats();

                    bootstrap.Modal.getInstance(document.getElementById('createAlbumModal')).hide();
                    form.reset();
                    this.showToast('Album created successfully!', 'success');

                } catch (error) {
                    this.showToast('Error creating album: ' + error.message, 'error');
                }
            }

            editAlbum(albumId) {
                const album = this.albums.find(a => a.id === albumId);
                if (!album) return;

                // Populate edit form
                document.getElementById('editAlbumId').value = album.id;
                document.getElementById('editAlbumName').value = album.name;
                document.getElementById('editAlbumType').value = album.type;
                document.getElementById('editAlbumCategory').value = album.category;
                document.getElementById('editAlbumDescription').value = album.description;
                document.getElementById('editAlbumPrivacy').value = album.privacy;
                document.getElementById('editAlbumTags').value = album.tags.join(', ');
                document.getElementById('editAllowComments').checked = album.allowComments;
                document.getElementById('editAllowDownload').checked = album.allowDownload;
                document.getElementById('editIsFeatured').checked = album.isFeatured;

                new bootstrap.Modal(document.getElementById('editAlbumModal')).show();
            }

            async updateAlbum() {
                const albumId = parseInt(document.getElementById('editAlbumId').value);
                const albumIndex = this.albums.findIndex(a => a.id === albumId);
                
                if (albumIndex === -1) return;

                const updatedData = {
                    name: document.getElementById('editAlbumName').value,
                    type: document.getElementById('editAlbumType').value,
                    category: document.getElementById('editAlbumCategory').value,
                    description: document.getElementById('editAlbumDescription').value,
                    privacy: document.getElementById('editAlbumPrivacy').value,
                    tags: document.getElementById('editAlbumTags').value.split(',').map(tag => tag.trim()).filter(tag => tag),
                    allowComments: document.getElementById('editAllowComments').checked,
                    allowDownload: document.getElementById('editAllowDownload').checked,
                    isFeatured: document.getElementById('editIsFeatured').checked
                };

                try {
                    // Simulate API call
                    const response = await fetch(`/api/albums/${albumId}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(updatedData)
                    });

                    // For demo, update locally
                    this.albums[albumIndex] = { ...this.albums[albumIndex], ...updatedData };
                    this.filterAlbums();
                    this.updateStats();

                    bootstrap.Modal.getInstance(document.getElementById('editAlbumModal')).hide();
                    this.showToast('Album updated successfully!', 'success');

                } catch (error) {
                    this.showToast('Error updating album: ' + error.message, 'error');
                }
            }

            async deleteAlbum(albumId) {
                if (!confirm('Are you sure you want to delete this album? This action cannot be undone.')) {
                    return;
                }

                try {
                    // Simulate API call
                    const response = await fetch(`/api/albums/${albumId}`, {
                        method: 'DELETE'
                    });

                    // For demo, remove locally
                    this.albums = this.albums.filter(a => a.id !== albumId);
                    this.filterAlbums();
                    this.updateStats();
                    this.showToast('Album deleted successfully!', 'success');

                } catch (error) {
                    this.showToast('Error deleting album: ' + error.message, 'error');
                }
            }

            viewAlbum(albumId) {
                const album = this.albums.find(a => a.id === albumId);
                if (!album) return;

                const modal = document.getElementById('albumDetailsModal');
                const title = document.getElementById('albumDetailsTitle');
                const content = document.getElementById('albumDetailsContent');

                title.textContent = album.name;

                const totalItems = album.photoCount + album.videoCount;
                const typeIcon = album.type === 'photo' ? 'camera' : 
                               album.type === 'video' ? 'video' : 'images';

                content.innerHTML = `
                    <div class="row">
                        <div class="col-md-4">
                            <img src="${album.cover}" alt="${album.name}" class="img-fluid rounded">
                        </div>
                        <div class="col-md-8">
                            <h4>${album.name}</h4>
                            <p class="text-muted">${album.description}</p>
                            
                            <div class="row mb-3">
                                <div class="col-sm-6">
                                    <strong>Type:</strong> 
                                    <span class="badge bg-${album.type === 'photo' ? 'success' : album.type === 'video' ? 'info' : 'primary'}">
                                        <i class="fas fa-${typeIcon}"></i> ${album.type}
                                    </span>
                                </div>
                                <div class="col-sm-6">
                                    <strong>Category:</strong> ${album.category}
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-sm-6">
                                    <strong>Privacy:</strong> ${album.privacy}
                                </div>
                                <div class="col-sm-6">
                                    <strong>Created:</strong> ${new Date(album.created).toLocaleDateString()}
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-sm-6">
                                    <strong>Photos:</strong> ${album.photoCount}
                                </div>
                                <div class="col-sm-6">
                                    <strong>Videos:</strong> ${album.videoCount}
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-sm-6">
                                    <strong>Total Size:</strong> ${album.totalSize}
                                </div>
                                <div class="col-sm-6">
                                    <strong>Total Items:</strong> ${totalItems}
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <strong>Tags:</strong><br>
                                ${album.tags.map(tag => `<span class="badge bg-light text-dark me-1">${tag}</span>`).join('')}
                            </div>
                            
                            <div class="mb-3">
                                <strong>Settings:</strong><br>
                                ${album.isFeatured ? '<span class="badge bg-warning me-1">Featured</span>' : ''}
                                ${album.allowComments ? '<span class="badge bg-success me-1">Comments Allowed</span>' : ''}
                                ${album.allowDownload ? '<span class="badge bg-info me-1">Download Allowed</span>' : ''}
                            </div>
                            
                            <div class="btn-group">
                                <button class="btn btn-primary" onclick="editAlbum(${album.id}); bootstrap.Modal.getInstance(document.getElementById('albumDetailsModal')).hide();">
                                    <i class="fas fa-edit"></i> Edit Album
                                </button>
                                <button class="btn btn-success">
                                    <i class="fas fa-plus"></i> Add Media
                                </button>
                                <button class="btn btn-info">
                                    <i class="fas fa-eye"></i> View Gallery
                                </button>
                            </div>
                        </div>
                    </div>
                `;

                new bootstrap.Modal(modal).show();
            }

            showToast(message, type = 'info') {
                const toastContainer = document.getElementById('toastContainer');
                const toastId = 'toast-' + Date.now();
                
                const toastHTML = `
                    <div class="toast" id="${toastId}" role="alert" aria-live="assertive" aria-atomic="true">
                        <div class="toast-header">
                            <i class="fas fa-${type === 'success' ? 'check-circle text-success' : 
                                              type === 'error' ? 'exclamation-circle text-danger' : 
                                              type === 'warning' ? 'exclamation-triangle text-warning' : 
                                              'info-circle text-info'}"></i>
                            <strong class="me-auto ms-2">Albums</strong>
                            <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
                        </div>
                        <div class="toast-body">${message}</div>
                    </div>
                `;
                
                toastContainer.insertAdjacentHTML('beforeend', toastHTML);
                const toast = new bootstrap.Toast(document.getElementById(toastId));
                toast.show();
                
                // Remove toast element after it's hidden
                document.getElementById(toastId).addEventListener('hidden.bs.toast', function() {
                    this.remove();
                });
            }
        }

        // Global functions
        function createAlbum() {
            albumsManager.createAlbum();
        }

        function updateAlbum() {
            albumsManager.updateAlbum();
        }

        function editAlbum(albumId) {
            albumsManager.editAlbum(albumId);
        }

        function deleteAlbum(albumId) {
            albumsManager.deleteAlbum(albumId);
        }

        function viewAlbum(albumId) {
            albumsManager.viewAlbum(albumId);
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                window.location.href = '../../../index.html';
            }
        }

        // Initialize albums manager when DOM is loaded
        let albumsManager;
        document.addEventListener('DOMContentLoaded', function() {
            albumsManager = new AlbumsManager();
        });
    </script>
</body>
</html>


